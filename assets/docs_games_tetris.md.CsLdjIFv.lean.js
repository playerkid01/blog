import{v as W,c as Z,o as ee,ae as te}from"./chunks/framework.Cd-3tpCq.js";const le=JSON.parse('{"title":"俄罗斯方块游戏","description":"","frontmatter":{},"headers":[],"relativePath":"docs/games/tetris.md","filePath":"docs/games/tetris.md"}'),ne={name:"docs/games/tetris.md"},se=Object.assign(ne,{setup(ae){return W(()=>{const C=document.getElementById("gameCanvas"),c=C.getContext("2d"),m=document.getElementById("nextPieceCanvas"),B=m.getContext("2d"),I=document.getElementById("score"),E=document.getElementById("level"),O=document.getElementById("startButton"),V=document.getElementById("pauseButton"),X=document.getElementById("restartButton"),w=document.getElementById("gameMessage"),l=30,P=C.height/l,p=C.width/l,k=25,M=[null,"#FF0D72","#0DC2FF","#FF0D72","#FFBA00","#0DFF72","#B20DFF","#FF8A00"],j=[[],[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[1,0,0],[1,1,1],[0,0,0]],[[0,0,1],[1,1,1],[0,0,0]],[[1,1],[1,1]],[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[1,1,1],[0,0,0]],[[1,1,0],[0,1,1],[0,0,0]]];let f=[],a=null,i=null,r=0,s=0,v=0,d=1,b=0,u=null,g=!1,x=!1;function F(){f=[];for(let e=0;e<P;e++){f[e]=[];for(let t=0;t<p;t++)f[e][t]=0}}function A(){const e=Math.floor(Math.random()*7)+1;return{type:e,shape:j[e],color:M[e]}}function G(){i||(i=A()),a=i,i=A(),r=Math.floor((p-a.shape[0].length)/2),s=0,y(a.shape,r,s)&&$(),K()}function q(e){const t=e.length,n=[];for(let o=0;o<t;o++){n[o]=[];for(let h=0;h<t;h++)n[o][h]=e[t-h-1][o]}return n}function y(e,t,n){for(let o=0;o<e.length;o++)for(let h=0;h<e[o].length;h++)if(e[o][h]){const D=t+h,R=n+o;if(D<0||D>=p||R>=P||R>=0&&f[R][D])return!0}return!1}function T(){for(let e=0;e<a.shape.length;e++)for(let t=0;t<a.shape[e].length;t++)if(a.shape[e][t]){const n=s+e;n>=0&&(f[n][r+t]=a.type)}z(),G()}function z(){let e=0;for(let t=P-1;t>=0;t--){let n=!0;for(let o=0;o<p;o++)if(f[t][o]===0){n=!1;break}n&&(f.splice(t,1),f.unshift(Array(p).fill(0)),t++,e++)}e>0&&(v+=[0,100,300,500,800][e]*d,b+=e,I.textContent=v,b>=d*10&&(d++,E.textContent=d,u&&(clearInterval(u),u=setInterval(L,1e3/d))))}function S(){c.fillStyle="#f0f0f0",c.fillRect(0,0,C.width,C.height),c.strokeStyle="#ddd";for(let e=0;e<P;e++)for(let t=0;t<p;t++)c.strokeRect(t*l,e*l,l,l);for(let e=0;e<P;e++)for(let t=0;t<p;t++)if(f[e][t]){const n=f[e][t];c.fillStyle=M[n],c.fillRect(t*l,e*l,l-1,l-1)}}function J(){if(a){c.fillStyle=a.color;for(let e=0;e<a.shape.length;e++)for(let t=0;t<a.shape[e].length;t++)if(a.shape[e][t]){const n=s+e;n>=0&&c.fillRect((r+t)*l,n*l,l-1,l-1)}}}function K(){if(!i)return;B.fillStyle="#f0f0f0",B.fillRect(0,0,m.width,m.height);const e=(m.width-i.shape[0].length*k)/2,t=(m.height-i.shape.length*k)/2;B.fillStyle=i.color;for(let n=0;n<i.shape.length;n++)for(let o=0;o<i.shape[n].length;o++)i.shape[n][o]&&B.fillRect(e+o*k,t+n*k,k-1,k-1)}function _(){S(),J()}function L(){!g||x||(y(a.shape,r,s+1)?T():s++,_())}function N(){g||(g=!0,x=!1,w.textContent="",F(),v=0,d=1,b=0,I.textContent=v,E.textContent=d,G(),u&&clearInterval(u),u=setInterval(L,1e3/d))}function Y(){g&&(x=!x,w.textContent=x?"游戏已暂停":"")}function $(){g=!1,clearInterval(u),w.textContent=`游戏结束！最终分数: ${v}`}function H(){g=!1,u&&clearInterval(u),F(),v=0,d=1,b=0,I.textContent=v,E.textContent=d,a=null,i=null,w.textContent="",S(),B.fillStyle="#f0f0f0",B.fillRect(0,0,m.width,m.height)}function Q(){if(!(!g||x)){for(;!y(a.shape,r,s+1);)s++;T(),_()}}function U(e){if(!g||x){e.keyCode===13&&N();return}switch([37,38,39,40,32].includes(e.keyCode)&&e.preventDefault(),e.keyCode){case 37:y(a.shape,r-1,s)||(r--,_());break;case 39:y(a.shape,r+1,s)||(r++,_());break;case 40:y(a.shape,r,s+1)||(s++,_());break;case 38:const t=q(a.shape);y(t,r,s)||(a.shape=t,_());break;case 32:Q();break;case 80:Y();break}}O.addEventListener("click",N),V.addEventListener("click",Y),X.addEventListener("click",H),document.addEventListener("keydown",U),F(),S()}),(C,c)=>(ee(),Z("div",null,c[0]||(c[0]=[te("",3)])))}});export{le as __pageData,se as default};
